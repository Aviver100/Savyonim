<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>טופס נסיעה</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f8ff; }
    input, select, textarea, button { display: block; margin: 10px 0; width: 100%; padding: 10px; }
    button { background: #2a5d84; color: white; border: none; cursor: pointer; }
    #loader, #successMsg { display: none; text-align: center; margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>טופס מילוי פרטי נסיעה</h2>
  <form id="ambulanceForm">
    <input name="שם הנהג / נהגת" placeholder="שם הנהג / נהגת" required>
    <input name="מספר זהות נהג / נהגת" placeholder="מספר זהות נהג / נהגת" required>
    <input name="ק&quot;מ יציאה" placeholder="ק\"מ יציאה" type="number" required>
    <input name="שעת יציאה" placeholder="שעת יציאה" type="time" required>
    <input name="שם פרטי" placeholder="שם פרטי" required>
    <input name="שם משפחה" placeholder="שם משפחה" required>
    <input name="נייד" placeholder="נייד" required>
    <input name="ת.ז." placeholder="ת.ז." required>
    <select name="קופת חולים" required>
      <option value="">בחר קופה</option>
      <option>כללית</option>
      <option>מאוחדת</option>
      <option>מכבי</option>
      <option>לאומית</option>
    </select>
    <input name="כתובת" placeholder="כתובת">
    <input name="מוצא" placeholder="מוצא">
    <input name="יעד" placeholder="יעד">
    <textarea name="מהות הנסיעה" placeholder="מהות הנסיעה"></textarea>
    <select name="הלוך ושוב" id="roundTrip" required>
      <option value="">בחר</option>
      <option>כן</option>
      <option>לא</option>
    </select>
    <div id="waitTimeContainer">
      <input name="זמן המתנה" placeholder="זמן המתנה">
    </div>
    <input name="ק&quot;מ חזרה" placeholder="ק\"מ חזרה" type="number">
    <input name="שעת חזרה" placeholder="שעת חזרה" type="time">
    <button type="submit">שלח</button>
    <div id="loader">שולח נתונים...</div>
    <div id="successMsg">הטופס נשלח בהצלחה!</div>
  </form>

  <script>
    const form = document.getElementById("ambulanceForm");
    const loader = document.getElementById("loader");
    const successMsg = document.getElementById("successMsg");
    const roundTrip = document.getElementById("roundTrip");
    const waitTimeContainer = document.getElementById("waitTimeContainer");

    roundTrip.addEventListener("change", () => {
      waitTimeContainer.style.display = roundTrip.value === "כן" ? "block" : "none";
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      loader.style.display = "block";
      successMsg.style.display = "none";

      const formData = new FormData(form);

      fetch("https://script.google.com/macros/s/AKfycbyEtys9XHtYsxzwmyHNyw5j5GJcz5jQi9el4vzYoKUBLYF7XxGGUy5vBG0xxrElsSzV/exec", {
        method: "POST",
        mode: "no-cors",
        body: formData
      }).then(() => {
        loader.style.display = "none";
        successMsg.style.display = "block";
        form.reset();
        waitTimeContainer.style.display = "none";
        setTimeout(() => successMsg.style.display = "none", 5000);
      }).catch(() => {
        loader.style.display = "none";
        alert("אירעה שגיאה בשליחה");
      });
    });
  </script>
</body>
</html>
